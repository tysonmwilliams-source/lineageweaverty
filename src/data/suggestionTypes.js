/**
 * Suggestion Types - Dignity Analysis System
 * 
 * Defines all suggestion types, their severity levels, icons,
 * and action types used by the analysis system.
 * 
 * @module suggestionTypes
 */

// ==================== SUGGESTION TYPES ====================

/**
 * All possible suggestion types generated by the analysis system
 */
export const SUGGESTION_TYPES = {
  // === MISSING TITLES ===
  'house-no-head': {
    id: 'house-no-head',
    name: 'House Without Head',
    description: 'A house has no designated head or primary dignity',
    category: 'missing-title',
    defaultSeverity: 'warning',
    icon: 'home'
  },
  'untitled-patriarch': {
    id: 'untitled-patriarch',
    name: 'Untitled Patriarch',
    description: 'Eldest living legitimate member has no title',
    category: 'missing-title',
    defaultSeverity: 'info',
    icon: 'user'
  },
  'cadet-no-title': {
    id: 'cadet-no-title',
    name: 'Cadet House Without Title',
    description: 'A cadet branch has no associated dignity',
    category: 'missing-title',
    defaultSeverity: 'info',
    icon: 'git-branch'
  },
  
  // === TENURE ISSUES ===
  'tenure-gap': {
    id: 'tenure-gap',
    name: 'Tenure Gap',
    description: 'Missing tenure records between holders',
    category: 'tenure',
    defaultSeverity: 'warning',
    icon: 'calendar'
  },
  'no-tenure-records': {
    id: 'no-tenure-records',
    name: 'No Tenure Records',
    description: 'Dignity has holder but no tenure history',
    category: 'tenure',
    defaultSeverity: 'info',
    icon: 'scroll-text'
  },
  'tenure-chain-suggestion': {
    id: 'tenure-chain-suggestion',
    name: 'Suggested Tenure Chain',
    description: 'Inferred tenure history from death dates',
    category: 'tenure',
    defaultSeverity: 'info',
    icon: 'link'
  },
  
  // === SUCCESSION ISSUES ===
  'deceased-holder': {
    id: 'deceased-holder',
    name: 'Deceased Holder',
    description: 'Current holder is deceased, title not transferred',
    category: 'succession',
    defaultSeverity: 'critical',
    icon: 'alert-triangle'
  },
  'orphaned-dignity': {
    id: 'orphaned-dignity',
    name: 'Orphaned Dignity',
    description: 'Dignity has no holder AND no associated house',
    category: 'succession',
    defaultSeverity: 'warning',
    icon: 'help-circle'
  },
  'succession-conflict': {
    id: 'succession-conflict',
    name: 'Succession Conflict',
    description: 'Multiple valid succession paths detected',
    category: 'succession',
    defaultSeverity: 'warning',
    icon: 'git-merge'
  },
  'vacant-hereditary': {
    id: 'vacant-hereditary',
    name: 'Vacant Hereditary Title',
    description: 'Hereditary dignity marked vacant but heirs exist',
    category: 'succession',
    defaultSeverity: 'warning',
    icon: 'crown'
  },
  
  // === DATA INTEGRITY ===
  'temporal-impossibility': {
    id: 'temporal-impossibility',
    name: 'Temporal Impossibility',
    description: 'Tenure dates conflict with person\'s lifespan',
    category: 'integrity',
    defaultSeverity: 'critical',
    icon: 'clock'
  },
  'circular-feudal-chain': {
    id: 'circular-feudal-chain',
    name: 'Circular Feudal Chain',
    description: 'Feudal hierarchy contains a loop',
    category: 'integrity',
    defaultSeverity: 'critical',
    icon: 'refresh-cw'
  },
  'widowed-dignity': {
    id: 'widowed-dignity',
    name: 'Widowed Dignity',
    description: 'Dignity linked to house that no longer exists',
    category: 'integrity',
    defaultSeverity: 'critical',
    icon: 'unlink'
  },
  'over-titled-person': {
    id: 'over-titled-person',
    name: 'Over-Titled Person',
    description: 'Person holds unusually many titles (possible error)',
    category: 'integrity',
    defaultSeverity: 'info',
    icon: 'alert-circle'
  }
};

// ==================== SUGGESTION CATEGORIES ====================

/**
 * Categories for grouping suggestions
 */
export const SUGGESTION_CATEGORIES = {
  'missing-title': {
    id: 'missing-title',
    name: 'Missing Titles',
    description: 'Houses or people that should have dignities',
    icon: 'crown',
    order: 1
  },
  'tenure': {
    id: 'tenure',
    name: 'Tenure Issues',
    description: 'Incomplete or missing tenure records',
    icon: 'scroll-text',
    order: 2
  },
  'succession': {
    id: 'succession',
    name: 'Succession Issues',
    description: 'Problems with title succession',
    icon: 'git-branch',
    order: 3
  },
  'integrity': {
    id: 'integrity',
    name: 'Data Integrity',
    description: 'Errors or inconsistencies in data',
    icon: 'alert-triangle',
    order: 4
  }
};

// ==================== SEVERITY LEVELS ====================

/**
 * Severity levels for suggestions
 */
export const SEVERITY_LEVELS = {
  critical: {
    id: 'critical',
    name: 'Critical',
    description: 'Requires immediate attention - data integrity issues',
    icon: 'alert-triangle',
    color: 'var(--color-error)',
    order: 1
  },
  warning: {
    id: 'warning',
    name: 'Warning',
    description: 'Should be addressed soon - incomplete data',
    icon: 'alert-circle',
    color: 'var(--color-warning)',
    order: 2
  },
  info: {
    id: 'info',
    name: 'Info',
    description: 'Optional improvements - suggestions',
    icon: 'info',
    color: 'var(--color-info)',
    order: 3
  }
};

// ==================== ACTION TYPES ====================

/**
 * Types of actions that can be taken on suggestions
 */
export const ACTION_TYPES = {
  'create-dignity': {
    id: 'create-dignity',
    name: 'Create Dignity',
    description: 'Create a new dignity record',
    icon: 'plus',
    requiresConfirmation: false
  },
  'update-dignity': {
    id: 'update-dignity',
    name: 'Update Dignity',
    description: 'Modify an existing dignity',
    icon: 'edit-3',
    requiresConfirmation: false
  },
  'delete-dignity': {
    id: 'delete-dignity',
    name: 'Delete Dignity',
    description: 'Remove a dignity record',
    icon: 'trash-2',
    requiresConfirmation: true
  },
  'transfer-dignity': {
    id: 'transfer-dignity',
    name: 'Transfer Dignity',
    description: 'End current tenure and start new one',
    icon: 'arrow-right-circle',
    requiresConfirmation: true
  },
  'create-tenure': {
    id: 'create-tenure',
    name: 'Create Tenure Record',
    description: 'Add historical tenure entry',
    icon: 'plus-circle',
    requiresConfirmation: false
  },
  'update-tenure': {
    id: 'update-tenure',
    name: 'Update Tenure Record',
    description: 'Modify existing tenure entry',
    icon: 'edit',
    requiresConfirmation: false
  },
  'create-tenure-chain': {
    id: 'create-tenure-chain',
    name: 'Create Tenure Chain',
    description: 'Add multiple tenure records',
    icon: 'link',
    requiresConfirmation: true
  },
  'fix-feudal-chain': {
    id: 'fix-feudal-chain',
    name: 'Fix Feudal Chain',
    description: 'Break circular reference in hierarchy',
    icon: 'scissors',
    requiresConfirmation: true
  },
  'mark-vacant': {
    id: 'mark-vacant',
    name: 'Mark as Vacant',
    description: 'Set dignity as vacant',
    icon: 'circle',
    requiresConfirmation: false
  },
  'link-to-house': {
    id: 'link-to-house',
    name: 'Link to House',
    description: 'Associate dignity with a house',
    icon: 'home',
    requiresConfirmation: false,
    requiresInput: true
  },
  'review': {
    id: 'review',
    name: 'Review',
    description: 'Manual review required',
    icon: 'eye',
    requiresConfirmation: false,
    navigateTo: true
  }
};

// ==================== HELPER FUNCTIONS ====================

/**
 * Get suggestion type by ID
 * @param {string} typeId - Type ID
 * @returns {Object|null} Suggestion type or null
 */
export function getSuggestionType(typeId) {
  return SUGGESTION_TYPES[typeId] || null;
}

/**
 * Get all types in a category
 * @param {string} categoryId - Category ID
 * @returns {Object[]} Array of suggestion types
 */
export function getTypesByCategory(categoryId) {
  return Object.values(SUGGESTION_TYPES).filter(t => t.category === categoryId);
}

/**
 * Get severity config
 * @param {string} severityId - Severity ID
 * @returns {Object|null} Severity config or null
 */
export function getSeverity(severityId) {
  return SEVERITY_LEVELS[severityId] || null;
}

/**
 * Get action type config
 * @param {string} actionId - Action ID
 * @returns {Object|null} Action config or null
 */
export function getActionType(actionId) {
  return ACTION_TYPES[actionId] || null;
}

/**
 * Sort suggestions by severity (critical first)
 * @param {Object[]} suggestions - Array of suggestions
 * @returns {Object[]} Sorted array
 */
export function sortBySeverity(suggestions) {
  const order = { critical: 0, warning: 1, info: 2 };
  return [...suggestions].sort((a, b) => {
    const severityDiff = order[a.severity] - order[b.severity];
    if (severityDiff !== 0) return severityDiff;
    return b.confidence - a.confidence;
  });
}

// ==================== EXPORTS ====================

export default {
  SUGGESTION_TYPES,
  SUGGESTION_CATEGORIES,
  SEVERITY_LEVELS,
  ACTION_TYPES,
  getSuggestionType,
  getTypesByCategory,
  getSeverity,
  getActionType,
  sortBySeverity
};
